<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:Menstrual_Health_App.ViewModels"
             xmlns:models="clr-namespace:Menstrual_Health_App.Models"
             x:Class="Menstrual_Health_App.MainPage"
             x:DataType="viewmodels:MainViewModel"
             Title="Cycle Tracker"
             BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource Black}}">

    <RefreshView Command="{Binding RefreshCommand}" IsRefreshing="{Binding IsLoading}">
        <ScrollView>
            <VerticalStackLayout Spacing="20" Padding="20">
                
                <Frame BackgroundColor="{Binding CurrentPhaseInfo.PhaseColor}" 
                       CornerRadius="20" 
                       Padding="20"
                       HasShadow="True">
                    <Frame.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding ViewPhaseInfoCommand}" />
                    </Frame.GestureRecognizers>
                    <VerticalStackLayout Spacing="10">
                        <Label Text="{Binding CurrentPhaseInfo.Icon}" 
                               FontSize="48" 
                               HorizontalOptions="Center" />
                        <Label Text="{Binding CurrentPhaseInfo.Title}" 
                               FontSize="24" 
                               FontAttributes="Bold" 
                               TextColor="White"
                               HorizontalOptions="Center" />
                        <Label Text="{Binding CycleDayDisplay}" 
                               FontSize="18" 
                               TextColor="White"
                               HorizontalOptions="Center" />
                        <Label Text="Tap for tips and information" 
                               FontSize="14" 
                               TextColor="White"
                               Opacity="0.8"
                               HorizontalOptions="Center" />
                    </VerticalStackLayout>
                </Frame>

                <Grid ColumnDefinitions="*,*" RowDefinitions="Auto" ColumnSpacing="10">
                    <Frame Grid.Column="0" 
                           BackgroundColor="{AppThemeBinding Light=#F8F8F8, Dark=#2C2C2C}" 
                           CornerRadius="15" 
                           Padding="15">
                        <VerticalStackLayout Spacing="5">
                            <Label Text="Next Period" 
                                   FontSize="12" 
                                   TextColor="Gray" />
                            <Label Text="{Binding NextPeriodDisplay}" 
                                   FontSize="20" 
                                   FontAttributes="Bold" />
                            <Label Text="{Binding DaysUntilPeriodDisplay, StringFormat='in {0}'}" 
                                   FontSize="14" 
                                   TextColor="Gray" />
                        </VerticalStackLayout>
                    </Frame>
                    <Frame Grid.Column="1" 
                           BackgroundColor="{AppThemeBinding Light=#F8F8F8, Dark=#2C2C2C}" 
                           CornerRadius="15" 
                           Padding="15">
                        <VerticalStackLayout Spacing="5">
                            <Label Text="Ovulation" 
                                   FontSize="12" 
                                   TextColor="Gray" />
                            <Label Text="{Binding NextOvulationDisplay}" 
                                   FontSize="20" 
                                   FontAttributes="Bold" />
                            <Label Text="expected" 
                                   FontSize="14" 
                                   TextColor="Gray" />
                        </VerticalStackLayout>
                    </Frame>
                </Grid>

                <Label Text="Quick Actions" 
                       FontSize="18" 
                       FontAttributes="Bold" 
                       Margin="0,10,0,0" />

                <Button Text="Log Period Start" 
                        Command="{Binding LogPeriodStartCommand}"
                        BackgroundColor="#E74C3C"
                        TextColor="White"
                        FontSize="16"
                        CornerRadius="10"
                        HeightRequest="50" />

                <Button Text="Log Period End" 
                        Command="{Binding LogPeriodEndCommand}"
                        BackgroundColor="#27AE60"
                        TextColor="White"
                        FontSize="16"
                        CornerRadius="10"
                        HeightRequest="50" />

                <Label Text="Cycle Phases" 
                       FontSize="18" 
                       FontAttributes="Bold" 
                       Margin="0,10,0,0" />

                <HorizontalStackLayout Spacing="10" HorizontalOptions="Center">
                    <Frame BackgroundColor="#E74C3C" CornerRadius="40" WidthRequest="70" HeightRequest="70" Padding="0">
                        <Frame.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding ViewPhaseCommand}" CommandParameter="Menstrual" />
                        </Frame.GestureRecognizers>
                        <VerticalStackLayout VerticalOptions="Center" HorizontalOptions="Center">
                            <Label Text="P" FontSize="24" HorizontalOptions="Center" TextColor="White" />
                            <Label Text="Period" FontSize="10" TextColor="White" HorizontalOptions="Center" />
                        </VerticalStackLayout>
                    </Frame>

                    <Frame BackgroundColor="#E91E63" CornerRadius="40" WidthRequest="70" HeightRequest="70" Padding="0">
                        <Frame.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding ViewPhaseCommand}" CommandParameter="Follicular" />
                        </Frame.GestureRecognizers>
                        <VerticalStackLayout VerticalOptions="Center" HorizontalOptions="Center">
                            <Label Text="F" FontSize="24" HorizontalOptions="Center" TextColor="White" />
                            <Label Text="Follicular" FontSize="10" TextColor="White" HorizontalOptions="Center" />
                        </VerticalStackLayout>
                    </Frame>

                    <Frame BackgroundColor="#FF9800" CornerRadius="40" WidthRequest="70" HeightRequest="70" Padding="0">
                        <Frame.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding ViewPhaseCommand}" CommandParameter="Ovulation" />
                        </Frame.GestureRecognizers>
                        <VerticalStackLayout VerticalOptions="Center" HorizontalOptions="Center">
                            <Label Text="O" FontSize="24" HorizontalOptions="Center" TextColor="White" />
                            <Label Text="Ovulation" FontSize="10" TextColor="White" HorizontalOptions="Center" />
                        </VerticalStackLayout>
                    </Frame>

                    <Frame BackgroundColor="#9C27B0" CornerRadius="40" WidthRequest="70" HeightRequest="70" Padding="0">
                        <Frame.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding ViewPhaseCommand}" CommandParameter="Luteal" />
                        </Frame.GestureRecognizers>
                        <VerticalStackLayout VerticalOptions="Center" HorizontalOptions="Center">
                            <Label Text="L" FontSize="24" HorizontalOptions="Center" TextColor="White" />
                            <Label Text="Luteal" FontSize="10" TextColor="White" HorizontalOptions="Center" />
                        </VerticalStackLayout>
                    </Frame>
                </HorizontalStackLayout>

                <Button Text="Settings" 
                        Command="{Binding OpenSettingsCommand}"
                        BackgroundColor="{AppThemeBinding Light=#E0E0E0, Dark=#404040}"
                        TextColor="{AppThemeBinding Light=Black, Dark=White}"
                        FontSize="16"
                        CornerRadius="10"
                        HeightRequest="50"
                        Margin="0,20,0,0" />

            </VerticalStackLayout>
        </ScrollView>
    </RefreshView>
</ContentPage>
